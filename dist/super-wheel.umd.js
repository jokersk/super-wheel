(function(d,f){typeof exports=="object"&&typeof module<"u"?module.exports=f():typeof define=="function"&&define.amd?define(f):(d=typeof globalThis<"u"?globalThis:d||self,d.SuperWheel=f())})(this,function(){"use strict";const d=function(i){i.target.hasAttribute("super:ignore")||(i.preventDefault(),i.stopPropagation(),!(i.touches.length>1)&&(this.touch.canAnimate=!1,this.touch.speed=0,this.touch.startY=i.touches[0].clientY,this.touch.lastX=i.touches[0].clientX,this.touch.lastY=this.touch.startY,this.touch.startAt=i.timeStamp))},f=function(i){if(i.touches.length>1)return;i.preventDefault(),i.stopPropagation();const t=this.getTouchDeltaY(i);t>window.innerHeight*.3||this.move(t)},y=function(i){if(i.target.hasAttribute("super:ignore")||(i.preventDefault(),i.stopPropagation(),i.touches.length>1))return;this.touch.canAnimate=!0;const t=window.innerHeight*2.5;let s=this.touch.speed*window.innerHeight;if(Math.abs(s)<100)return;s>t&&(s=t),s<-t&&(s=-t);let e=0,o=0;function h(n,c,a,w){return a*((n=n/w-1)*n*n+1)+c}const r=100,u=()=>{const n=h(e,0,s,r);this.move(n-o),o=n,e+=1,e<r&&this.touch.canAnimate&&requestAnimationFrame(u)};requestAnimationFrame(u)},k=function(i){const t=this.touch.lastX-i.touches[0].clientX,s=this.touch.lastY-i.touches[0].clientY;return Math.abs(t)>Math.abs(s)?0:(this.touch.lastY=i.touches[0].clientY,this.touch.lastX=i.touches[0].clientX,this.touch.distance=s,this.touch.lastDuration=i.timeStamp-this.touch.lastMoveTime,this.touch.lastMoveTime=i.timeStamp,this.touch.speed=this.touch.distance/this.touch.lastDuration,s)};let m=[];const b=()=>({listen(i){m.push(i)},dispatch(i){for(const t of m)t(i)},clear(){m=[]}}),H=(i,t,s)=>(100/(t-i)*(s-i)/100).toFixed(6),g=()=>{},C=i=>(()=>{const s={ranges:[],otherwises:[],get lastRange(){return this.ranges[this.ranges.length-1]},inFromObject(e){if(!e.hasOwnProperty("default"))throw"responsive must has default key";const o=e;let h=e.default[0],r=e.default[1];for(const n of Object.keys(p).reverse())if(n in e&&window.innerWidth>=p[n]){h=e[n][0],r=e[n][1];break}h==="auto"&&(h=this.lastRange.end),typeof r=="string"&&r.includes("+")&&(r=h+parseFloat(r.slice(1)));const u={start:h,end:r,callback:g,responsive:o};this.ranges.push(u)},in(e,o){if(arguments.length===1&&typeof e=="object")return this.inFromObject(e),this;e==="auto"&&(e=this.lastRange.end),typeof o=="string"&&o.includes("+")&&(o=e+parseFloat(o.slice(1)));const h={start:e,end:o,callback:g,responsive:null};return this.ranges.push(h),this},once(e){let o=()=>{o=g,e()};return this.lastRange.callback=()=>o(),this},do(e){return this.lastRange.callback=e,this},fadeIn(e){const o={is:h=>window.innerWidth>=p[h]};return this.lastRange.callback=h=>{i&&i(h,o),e&&e(h,o)},this},fadeOut(e){return this.lastRange.callback=o=>{const h=+(1-o).toFixed(2);i&&i(h),e&&e(h)},this},otherwise(e){return this.otherwises.push(e),this}};return b().listen(({process:e,value:o})=>{let h=()=>s.otherwises.forEach(n=>n());const r=(n,c)=>{for(const a of Object.keys(p).reverse())if(n.responsive[a]&&window.innerWidth>=p[a])return c(n.responsive[a][0],n.responsive[a][1])},u=n=>(c,a)=>{if(e>c&&e<=a)return n(c,a,e)};s.ranges.forEach(n=>{let c=u((a,w,v)=>{n.callback(H(a,w,v),{process:v,value:o}),h=g});if(n.responsive){r(n,c);return}c(n.start,n.end)}),h()}),s})(),p={default:0,sm:640,md:768,lg:1024,xl:1280,"2xl":1536};class l{constructor(t){this.root=t,this.setupRoot(),this.firstChildren=null,this.setUpFirstChildren(),this.root.onwheel=this.update.bind(this),this.touch={startAt:null,lastY:null,lastX:null,startY:null,distance:null,speed:null,lastMoveTime:null,lastDuration:null,canAnimate:!0},this.mobile(),this.topValue=0,this.onUpdates=[],this.totalHeight=0,window.addEventListener("resize",this.setupRoot.bind(this)),this.getTouchDeltaY=k.bind(this),this.listeners=[],this.onScroll=b()}static debug(){const t=window.document.createElement("div");t.setAttribute("style","position: fixed; bottom: 0; right: 0; color: white; background: black; z-index: 999"),document.body.appendChild(t),l.debugEl=t,l.updateDebug()}static updateDebug(){this.debugEl&&(this.debugEl.textContent=l.getInstance().process.toFixed(3))}static getInstance(){if(!l.instance)throw"please create a SuperWheel instance";return l.instance}static create(t,s){const e=new this(t);return l.instance=e,s!=null&&s.onMounted&&e.onMounted(s==null?void 0:s.onMounted),e.mounted(),e}static in(...t){const s=t[t.length-1]instanceof Function?t[t.length-1]:()=>{};return C(s).in(...t)}mounted(){this.listeners.forEach(t=>t(this))}get process(){return this.totalHeight?Math.round(Math.abs(-this.topValue/this.totalHeight)*1e3)/1e3:0}onMounted(t){this.listeners.push(t)}setTotalHeight(){if(this.totalHeight=this.firstChildren.getBoundingClientRect().height-window.innerHeight,!this.totalHeight)throw"totalHeight can not be 0"}setUpFirstChildren(){if(!this.root.children.length)throw"can not found first children of root";this.firstChildren=this.root.children[0],this.firstChildren.style.position="absolute",this.firstChildren.style.left="0px",this.firstChildren.style.width="100%",setTimeout(()=>{this.setTotalHeight()})}updateChildTop(t){this.firstChildren.style.top=`${t}px`}setupRoot(){const t=window.innerHeight;this.root.setAttribute("style",`height: ${t}px; position: fixed; overflow: hidden; width: 100%`)}move(t){let s=this.topValue-t;if(s>0&&(s=0),!(-s>this.totalHeight)){this.topValue=s,this.updateChildTop(this.topValue),this.onScroll.dispatch({process:this.process,value:this.topValue});for(const e of this.onUpdates)e(this);l.updateDebug()}}mobile(){this.root.addEventListener("touchstart",d.bind(this)),this.root.addEventListener("touchmove",f.bind(this)),this.root.addEventListener("touchend",y.bind(this))}update(t){t.preventDefault(),t.stopPropagation();const s=t.deltaY;this.move(s)}onUpdate(t){this.onUpdates.push(t)}fade(t,s){}clearUp(){this.onUpdates=[],this.updateChildTop(0)}}return l});
